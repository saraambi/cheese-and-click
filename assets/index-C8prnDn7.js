import{r as b,a as Z,u as D,b as ee,c as U,B as te,R as se,d as $,e as ae}from"./vendor-BzlqspOE.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();var X={exports:{}},B={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var re=b,ne=Symbol.for("react.element"),oe=Symbol.for("react.fragment"),ie=Object.prototype.hasOwnProperty,le=re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ce={key:!0,ref:!0,__self:!0,__source:!0};function V(t,o,n){var s,a={},r=null,d=null;n!==void 0&&(r=""+n),o.key!==void 0&&(r=""+o.key),o.ref!==void 0&&(d=o.ref);for(s in o)ie.call(o,s)&&!ce.hasOwnProperty(s)&&(a[s]=o[s]);if(t&&t.defaultProps)for(s in o=t.defaultProps,o)a[s]===void 0&&(a[s]=o[s]);return{$$typeof:ne,type:t,key:r,ref:d,props:a,_owner:le.current}}B.Fragment=oe;B.jsx=V;B.jsxs=V;X.exports=B;var e=X.exports,G={},q=Z;G.createRoot=q.createRoot,G.hydrateRoot=q.hydrateRoot;function T({variant:t="primary",size:o="md",disabled:n=!1,children:s,onClick:a,className:r="",...d}){const m="font-bold rounded-full shadow-lg transform transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",l={primary:"bg-gradient-to-r from-pink-400 to-purple-500 text-white hover:from-pink-500 hover:to-purple-600",secondary:"bg-gradient-to-r from-blue-400 to-cyan-500 text-white hover:from-blue-500 hover:to-cyan-600",danger:"bg-gradient-to-r from-red-400 to-pink-500 text-white hover:from-red-500 hover:to-pink-600",ghost:"bg-white/20 backdrop-blur-sm text-white hover:bg-white/30 border-2 border-white/50"},i={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg",xl:"px-10 py-5 text-xl"};return e.jsx("button",{className:`${m} ${l[t]} ${i[o]} ${r}`,onClick:a,disabled:n,...d,children:s})}function S({children:t,className:o="",hoverable:n=!0,onClick:s,...a}){const r="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-8",d=n?"transform transition-all duration-300 hover:scale-105 cursor-pointer":"";return e.jsx("div",{className:`${r} ${d} ${o}`,onClick:s,...a,children:t})}function de({message:t,type:o="info",duration:n=3e3,onClose:s}){const[a,r]=b.useState(!0);b.useEffect(()=>{const l=setTimeout(()=>{r(!1),setTimeout(()=>{s&&s()},300)},n);return()=>clearTimeout(l)},[n,s]);const d={success:"bg-green-500 text-white",error:"bg-red-500 text-white",warning:"bg-yellow-500 text-white",info:"bg-blue-500 text-white"},m={success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"};return a?e.jsxs("div",{className:`fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-6 py-4 rounded-full shadow-2xl flex items-center gap-3 animate-slide-in ${d[o]}`,style:{animation:"slideDown 0.3s ease-out"},children:[e.jsx("span",{className:"text-2xl",children:m[o]}),e.jsx("span",{className:"font-semibold text-lg",children:t})]}):null}function L(){const[t,o]=b.useState([]),n=(a,r="info",d=3e3)=>{const m=Date.now();o(l=>[...l,{id:m,message:a,type:r,duration:d}])},s=a=>{o(r=>r.filter(d=>d.id!==a))};return b.useEffect(()=>(window.showToast=n,()=>{delete window.showToast}),[]),e.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 flex flex-col gap-2",children:t.map((a,r)=>e.jsx(de,{message:a.message,type:a.type,duration:a.duration,onClose:()=>s(a.id)},a.id))})}function K(t){b.useEffect(()=>{const o=n=>{const s=t[n.key];s&&s(n)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[t])}function he(t){K({Enter:t})}function me(){const t=D(),[o,n]=b.useState(!1),s=()=>{n(!0),window.showToast&&window.showToast("Starting your photobooth experience! üéâ","success",2e3),setTimeout(()=>{t("/select-frame")},300)};return b.useEffect(()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||window.showToast&&window.showToast("Camera may not be available on this device","warning",4e3)},[]),he(()=>{o||s()}),e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx(L,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-20 left-20 text-6xl animate-float",style:{animationDelay:"0s"},children:"‚ú®"}),e.jsx("div",{className:"absolute top-40 right-32 text-5xl animate-float",style:{animationDelay:"1s"},children:"üåü"}),e.jsx("div",{className:"absolute bottom-32 left-32 text-6xl animate-float",style:{animationDelay:"2s"},children:"üí´"}),e.jsx("div",{className:"absolute bottom-20 right-20 text-5xl animate-float",style:{animationDelay:"1.5s"},children:"‚≠ê"})]}),e.jsxs("div",{className:"text-center z-10 animate-slide-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-8xl md:text-9xl font-bold text-white text-shadow-lg mb-4 animate-glow",children:"üßÄ Cheese & Click üì∏"}),e.jsx("p",{className:"text-3xl md:text-4xl text-white/95 text-shadow-lg font-semibold",children:"Your Virtual Photobooth Experience"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 max-w-5xl mx-auto",children:[e.jsxs(S,{hoverable:!1,className:"animate-slide-in",style:{animationDelay:"0.1s"},children:[e.jsx("div",{className:"text-5xl mb-3",children:"üñºÔ∏è"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Choose Your Frame"}),e.jsx("p",{className:"text-gray-600",children:"Select from 3, 4, or 6 photo layouts"})]}),e.jsxs(S,{hoverable:!1,className:"animate-slide-in",style:{animationDelay:"0.2s"},children:[e.jsx("div",{className:"text-5xl mb-3",children:"üì∏"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Capture Moments"}),e.jsx("p",{className:"text-gray-600",children:"Take beautiful photos with countdown timer"})]}),e.jsxs(S,{hoverable:!1,className:"animate-slide-in",style:{animationDelay:"0.3s"},children:[e.jsx("div",{className:"text-5xl mb-3",children:"üé®"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Customize & Share"}),e.jsx("p",{className:"text-gray-600",children:"Apply filters and templates, then download"})]})]}),e.jsxs("div",{className:"animate-slide-in",style:{animationDelay:"0.4s"},children:[e.jsx(T,{variant:"primary",size:"xl",onClick:s,disabled:o,className:"min-w-[300px] w-full sm:w-auto",autoFocus:!0,children:o?"Starting...":"üéâ Start Your Photobooth Experience"}),e.jsxs("p",{className:"mt-4 text-white/70 text-sm",children:["Press ",e.jsx("kbd",{className:"px-2 py-1 bg-white/20 rounded text-xs",children:"Enter"})," to start"]})]}),e.jsx("p",{className:"mt-8 text-white/80 text-lg",children:"Make sure your camera is ready! üì∑"})]})]})}function fe(){const t=D(),[o,n]=b.useState(null),[s,a]=b.useState(!1),r=[{id:3,label:"3 Photos",emoji:"üì∑üì∑üì∑",description:"Vertical layout - Perfect for single portraits",layout:"vertical",preview:["1","2","3"]},{id:4,label:"4 Photos",emoji:"üì∏üì∏üì∏üì∏",description:"Square layout (2√ó2) - Ideal for couples",layout:"square",preview:["1","2","3","4"]},{id:6,label:"6 Photos",emoji:"üì∑üì∑üì∑üì∑üì∑üì∑",description:"Rectangle layout (2√ó3) - Great for groups",layout:"rectangle",preview:["1","2","3","4","5","6"]}],d=i=>{n(i)},m=()=>{o&&(a(!0),setTimeout(()=>{t(`/camera?frames=${o}`)},300))},l=()=>{a(!0),setTimeout(()=>{t("/")},300)};return e.jsxs("div",{className:`min-h-screen flex items-center justify-center p-4 transition-opacity duration-300 ${s?"opacity-0":"opacity-100"}`,children:[e.jsx(L,{}),e.jsxs("div",{className:"text-center w-full max-w-6xl",children:[e.jsxs("div",{className:"mb-10 animate-slide-in",children:[e.jsx("h1",{className:"text-6xl md:text-7xl font-bold text-white text-shadow-lg mb-4",children:"Choose Your Frame üñºÔ∏è"}),e.jsx("p",{className:"text-2xl text-white/90 text-shadow",children:"Select how many photos you'd like to take"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-10",children:r.map((i,x)=>e.jsxs(S,{onClick:()=>d(i.id),className:`cursor-pointer transition-all duration-300 ${o===i.id?"ring-4 ring-yellow-400 scale-105 shadow-3xl bg-gradient-to-br from-yellow-50 to-pink-50":"hover:ring-2 hover:ring-white/50"} animate-slide-in`,style:{animationDelay:`${x*.1}s`},children:[e.jsx("div",{className:"text-7xl mb-4",children:i.emoji}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-3",children:i.label}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:i.description}),e.jsx("div",{className:`grid gap-2 ${i.id===3?"grid-cols-1":(i.id===4,"grid-cols-2")}`,children:i.preview.map((w,h)=>e.jsx("div",{className:`bg-gradient-to-br from-pink-200 to-purple-200 rounded-lg flex items-center justify-center text-2xl font-bold text-gray-600 border-2 border-white ${i.id===3?"aspect-[3/4]":"aspect-square"}`,children:w},h))}),o===i.id&&e.jsx("div",{className:"mt-4 text-yellow-600 font-bold text-lg animate-bounce",children:"‚úì Selected"})]},i.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsx(T,{variant:"primary",size:"lg",onClick:m,disabled:!o||s,className:"min-w-[250px]",children:s?"Loading...":`Continue with ${o||"..."} Photos ‚û°Ô∏è`}),e.jsx(T,{variant:"ghost",size:"lg",onClick:l,disabled:s,children:"‚Üê Back to Start"})]}),!o&&e.jsx("p",{className:"mt-6 text-white/70 text-lg animate-pulse",children:"üëÜ Click on a frame option above to select"})]})]})}function ue({seconds:t=3,onComplete:o,autoStart:n=!1}){const[s,a]=b.useState(t),[r,d]=b.useState(n);return b.useEffect(()=>{if(r)if(s>0){const m=setTimeout(()=>a(s-1),1e3);return()=>clearTimeout(m)}else d(!1),o&&o()},[s,r,o]),!r&&!n?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsx("div",{className:"text-center",children:s>0?e.jsx("div",{className:"text-9xl font-bold text-white drop-shadow-2xl animate-pulse",children:s}):e.jsx("div",{className:"text-8xl animate-bounce",children:"üì∏"})})})}function xe({progress:t=0,total:o=100,showLabel:n=!0,className:s=""}){const a=Math.min(100,Math.max(0,t/o*100));return e.jsxs("div",{className:`w-full ${s}`,children:[n&&e.jsxs("div",{className:"flex justify-between mb-2 text-white text-shadow",children:[e.jsx("span",{className:"font-semibold",children:"Progress"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(a),"%"]})]}),e.jsx("div",{className:"w-full bg-white/20 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-pink-400 via-purple-500 to-blue-500 h-full transition-all duration-500 ease-out rounded-full relative overflow-hidden",style:{width:`${a}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})})]})}function H({size:t="md",className:o=""}){const n={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"};return e.jsx("div",{className:`${n[t]} ${o}`,children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-pink-200 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-pink-500 rounded-full animate-spin"})]})})}function ge(){const t=D(),[o]=ee(),n=parseInt(o.get("frames"))||4,[s,a]=b.useState(0),[r,d]=b.useState([]),[m,l]=b.useState(!1),[i,x]=b.useState(!1),[w,h]=b.useState(null),[y,v]=b.useState(!1),g=b.useRef(null),u=b.useRef(null),j=b.useRef(null);b.useEffect(()=>(p(),()=>{N()}),[]);const p=async()=>{try{h(null),window.showToast&&window.showToast("Accessing camera...","info",2e3);const C=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}});g.current&&(g.current.srcObject=C,j.current=C,window.showToast&&window.showToast("Camera ready! üì∑","success",2e3))}catch(C){console.error("Error accessing camera:",C);const P=C.name==="NotAllowedError"?"Camera permission denied. Please allow camera access.":"Unable to access camera. Please check permissions and try again.";h(P),window.showToast&&window.showToast(P,"error",5e3)}},N=()=>{j.current&&(j.current.getTracks().forEach(C=>C.stop()),j.current=null)},f=()=>{x(!1),k()},c=()=>{s>=n||x(!0)},k=()=>{if(!g.current||!u.current||m)return;l(!0),v(!0);const C=u.current,P=g.current;C.width=P.videoWidth,C.height=P.videoHeight;const O=C.getContext("2d");O.save(),O.scale(-1,1),O.drawImage(P,-C.width,0),O.restore();const J=C.toDataURL("image/png");setTimeout(()=>{d(Q=>{const F=[...Q,J];return a(F.length),l(!1),v(!1),window.showToast&&window.showToast(`Photo ${F.length} captured! ‚ú®`,"success",2e3),F.length>=n&&(window.showToast&&window.showToast("All photos captured! Moving to customization...","success",3e3),N(),setTimeout(()=>{t("/template-filter",{state:{photos:F,photoCount:n}})},500)),F})},300)},A=()=>{r.length>0&&(d(C=>C.slice(0,-1)),a(C=>Math.max(0,C-1)))},z=()=>{r.length>0&&(N(),t("/template-filter",{state:{photos:[...r],photoCount:n}}))},E=()=>{N(),t("/select-frame")};return K({" ":C=>{C.preventDefault(),!m&&!i&&s<n&&c()},r:C=>{r.length>0&&!m&&!i&&A()},Escape:()=>{E()}}),w?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(S,{className:"max-w-md text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì∑‚ùå"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Camera Access Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:w}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(T,{variant:"primary",onClick:p,children:"Try Again üîÑ"}),e.jsx(T,{variant:"ghost",onClick:E,children:"‚Üê Go Back"})]})]})}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:[e.jsx(L,{}),i&&e.jsx(ue,{seconds:3,onComplete:f,autoStart:!0}),e.jsxs("div",{className:"text-center mb-4 md:mb-6 animate-slide-in",children:[e.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-bold text-white text-shadow-lg mb-2",children:["üì∏ Photo ",s+1," of ",n]}),e.jsx("p",{className:"text-lg sm:text-xl text-white/90 text-shadow",children:y?"Processing...":"Get ready and strike a pose! ‚ú®"}),e.jsxs("p",{className:"mt-2 text-white/70 text-sm",children:["Press ",e.jsx("kbd",{className:"px-2 py-1 bg-white/20 rounded text-xs",children:"Space"})," to capture"]}),e.jsx("div",{className:"mt-4 w-full max-w-md",children:e.jsx(xe,{progress:s,total:n})})]}),e.jsxs(S,{className:"mb-4 md:mb-6 relative max-w-4xl w-full",children:[e.jsxs("div",{className:"relative bg-black rounded-xl md:rounded-2xl overflow-hidden aspect-video",children:[e.jsx("video",{ref:g,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{transform:"scaleX(-1)"}}),m&&e.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:e.jsx("div",{className:"text-8xl animate-bounce",children:"üì∏"})}),y&&e.jsxs("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center flex-col gap-4",children:[e.jsx(H,{size:"lg"}),e.jsx("div",{className:"text-white text-2xl font-semibold",children:"Processing..."})]})]}),e.jsx("canvas",{ref:u,className:"hidden"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 md:gap-4 justify-center mb-4 md:mb-6 w-full max-w-2xl",children:[e.jsx(T,{variant:"primary",size:"lg",onClick:c,disabled:m||s>=n||i,className:"w-full sm:w-auto sm:min-w-[200px]",children:m?"Capturing...":"üì∑ Take Photo"}),r.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{variant:"secondary",size:"lg",onClick:A,disabled:m||i,className:"w-full sm:w-auto",children:"üîÑ Retake Last"}),e.jsxs(T,{variant:"secondary",size:"lg",onClick:z,disabled:m||i,className:"w-full sm:w-auto",children:["Finish (",r.length,"/",n,") ‚úÖ"]})]})]}),r.length>0&&e.jsxs(S,{className:"max-w-4xl w-full mb-4 md:mb-6",children:[e.jsxs("h3",{className:"text-lg md:text-xl font-bold text-gray-800 mb-3 md:mb-4 text-center",children:["Your Photos (",r.length,"/",n,")"]}),e.jsx("div",{className:`grid gap-2 md:gap-3 ${r.length<=3?"grid-cols-3":r.length<=4?"grid-cols-2 sm:grid-cols-4":"grid-cols-3 sm:grid-cols-6"}`,children:r.map((C,P)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:C,alt:`Photo ${P+1}`,className:"w-full h-auto rounded-lg border-2 border-pink-300 shadow-lg"}),e.jsx("div",{className:"absolute top-1 right-1 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:P+1})]},P))})]}),e.jsx(T,{variant:"ghost",onClick:E,disabled:m||i,children:"‚Üê Back to Frame Selection"})]})}function W(t,o,n,s,a,r){t.beginPath(),t.moveTo(o+r,n),t.lineTo(o+s-r,n),t.quadraticCurveTo(o+s,n,o+s,n+r),t.lineTo(o+s,n+a-r),t.quadraticCurveTo(o+s,n+a,o+s-r,n+a),t.lineTo(o+r,n+a),t.quadraticCurveTo(o,n+a,o,n+a-r),t.lineTo(o,n+r),t.quadraticCurveTo(o,n,o+r,n),t.closePath()}function pe(t,o){const n=t.getContext("2d"),s=n.getImageData(0,0,t.width,t.height),a=s.data;switch(o){case"filter-pink":for(let r=0;r<a.length;r+=4)a[r]=Math.min(255,a[r]*1.2),a[r+1]=Math.min(255,a[r+1]*1.1),a[r+2]=Math.min(255,a[r+2]*1.15);break;case"filter-sunset":for(let r=0;r<a.length;r+=4)a[r]=Math.min(255,a[r]*1.3),a[r+1]=Math.min(255,a[r+1]*1.1),a[r+2]=Math.min(255,a[r+2]*.9);break;case"filter-vintage":for(let r=0;r<a.length;r+=4){const d=a[r],m=a[r+1],l=a[r+2];a[r]=Math.min(255,d*.393+m*.769+l*.189),a[r+1]=Math.min(255,d*.349+m*.686+l*.168),a[r+2]=Math.min(255,d*.272+m*.534+l*.131)}break;case"filter-bright":for(let r=0;r<a.length;r+=4)a[r]=Math.min(255,a[r]*1.2+20),a[r+1]=Math.min(255,a[r+1]*1.2+20),a[r+2]=Math.min(255,a[r+2]*1.2+20);break;default:return}n.putImageData(s,0,0)}function we(t){return new Promise((o,n)=>{const s=new Image;s.onload=()=>o(s),s.onerror=n,s.src=t})}function be(t,o,n,s,a){if(!o||o.length===0||o.every(m=>!m))return t;const r=n*.005,d=s*.01;switch(a){case 3:const m=o.filter(p=>p).reduce((p,N)=>p+N.width/N.height,0)/o.filter(p=>p).length,i=(s-r*2-d*2)/3,x=i*m,w=Math.min(x,n-r*2),h=(n-w)/2;return[{x:h,y:r,w,h:i},{x:h,y:r+i+d,w,h:i},{x:h,y:r+(i+d)*2,w,h:i}];case 4:const y=(n-r*2-d)/2,v=[];for(let p=0;p<4;p++)if(o[p]){const N=o[p].width/o[p].height;let f;N>1,f=y;const c=p%2,k=Math.floor(p/2);v.push({x:r+c*(f+d),y:r+k*(f+d),w:f,h:f})}else v.push(t[p]);return v;case 6:const g=(n-r*2-d)/2,u=(s-r*2-d*2)/3,j=[];for(let p=0;p<6;p++)if(o[p]){const N=o[p].width/o[p].height,f=g/u;let c,k;N>f?(c=g,k=g/N):(k=u,c=u*N);const A=p%2,z=Math.floor(p/2),E=r+A*(g+d)+(g-c)/2,C=r+z*(u+d)+(u-k)/2;j.push({x:E,y:C,w:c,h:k})}else j.push(t[p]);return j;default:return t}}function ye(t,o,n){const s=o*.005,a=n*.01;switch(t){case 3:const r=(n-s*2-a*2)/3,d=o-s*2;return[{x:s,y:s,w:d,h:r},{x:s,y:s+r+a,w:d,h:r},{x:s,y:s+(r+a)*2,w:d,h:r}];case 4:const m=(o-s*2-a)/2;return[{x:s,y:s,w:m,h:m},{x:s+m+a,y:s,w:m,h:m},{x:s,y:s+m+a,w:m,h:m},{x:s+m+a,y:s+m+a,w:m,h:m}];case 6:const l=(o-s*2-a)/2,i=(n-s*2-a*2)/3;return[{x:s,y:s,w:l,h:i},{x:s+l+a,y:s,w:l,h:i},{x:s,y:s+i+a,w:l,h:i},{x:s+l+a,y:s+i+a,w:l,h:i},{x:s,y:s+(i+a)*2,w:l,h:i},{x:s+l+a,y:s+(i+a)*2,w:l,h:i}];default:const x=(n-s*2-(t-1)*a)/t;return Array.from({length:t},(w,h)=>({x:s,y:s+h*(x+a),w:o-s*2,h:x}))}}function je(t,o,n){if(!o||o.length===0)return;let s=1/0,a=1/0,r=-1/0,d=-1/0;o.forEach(y=>{s=Math.min(s,y.x),a=Math.min(a,y.y),r=Math.max(r,y.x+y.w),d=Math.max(d,y.y+y.h)});const m=Math.min(r-s,d-a)*.04,l=s-m,i=a-m,x=r-s+m*2,w=d-a+m*2,h=Math.min(x,w)*.02;switch(t.save(),t.strokeStyle=n.patternColor,t.fillStyle=n.patternColor,t.lineWidth=h,t.shadowColor="rgba(0, 0, 0, 0.2)",t.shadowBlur=5,n.patternType){case"heart":const y=Math.min(x,w)*.015,v=y*2.5;for(let c=l+v;c<l+x-v;c+=v)M(t,c,i+h/2,y);for(let c=l+v;c<l+x-v;c+=v)M(t,c,i+w-h/2,y);for(let c=i+v;c<i+w-v;c+=v)M(t,l+h/2,c,y);for(let c=i+v;c<i+w-v;c+=v)M(t,l+x-h/2,c,y);M(t,l+h,i+h,y*1.2),M(t,l+x-h,i+h,y*1.2),M(t,l+h,i+w-h,y*1.2),M(t,l+x-h,i+w-h,y*1.2);break;case"star":const g=Math.min(x,w)*.018,u=g*2.8;for(let c=l+u;c<l+x-u;c+=u)R(t,c,i+h/2,g,5),R(t,c,i+w-h/2,g,5);for(let c=i+u;c<i+w-u;c+=u)R(t,l+h/2,c,g,5),R(t,l+x-h/2,c,g,5);R(t,l+h,i+h,g*1.5,5),R(t,l+x-h,i+h,g*1.5,5),R(t,l+h,i+w-h,g*1.5,5),R(t,l+x-h,i+w-h,g*1.5,5);break;case"flower":const j=Math.min(x,w)*.015,p=j*2.8;for(let c=l+p;c<l+x-p;c+=p)I(t,c,i+h/2,j),I(t,c,i+w-h/2,j);for(let c=i+p;c<i+w-p;c+=p)I(t,l+h/2,c,j),I(t,l+x-h/2,c,j);I(t,l+h,i+h,j*1.3),I(t,l+x-h,i+h,j*1.3),I(t,l+h,i+w-h,j*1.3),I(t,l+x-h,i+w-h,j*1.3);break;case"simple":default:t.strokeStyle=n.patternColor,t.lineWidth=h*.6,t.strokeRect(l,i,x,w);const N=h*.8;t.strokeRect(l+N,i+N,x-N*2,w-N*2);const f=h*2;_(t,l,i,f),_(t,l+x,i,f),_(t,l,i+w,f),_(t,l+x,i+w,f);break}t.restore()}function M(t,o,n,s){t.save(),t.translate(o,n),t.beginPath(),t.moveTo(0,s/4),t.bezierCurveTo(0,0,-s/2,0,-s/2,s/4),t.bezierCurveTo(-s/2,s/2,0,s*.75,0,s),t.bezierCurveTo(0,s*.75,s/2,s/2,s/2,s/4),t.bezierCurveTo(s/2,0,0,0,0,s/4),t.closePath(),t.fill(),t.restore()}function R(t,o,n,s,a){t.save(),t.translate(o,n),t.beginPath();for(let r=0;r<a*2;r++){const d=Math.PI*r/a,m=r%2===0?s:s/2,l=Math.cos(d)*m,i=Math.sin(d)*m;r===0?t.moveTo(l,i):t.lineTo(l,i)}t.closePath(),t.fill(),t.restore()}function I(t,o,n,s){t.save(),t.translate(o,n);const a=5;for(let m=0;m<a;m++){const l=Math.PI*2*m/a,i=Math.cos(l)*s*.35,x=Math.sin(l)*s*.35;t.save(),t.translate(i,x),t.rotate(l),t.beginPath(),t.ellipse(0,0,s*.25,s*.4,0,0,Math.PI*2),t.fill(),t.restore()}const r=t.fillStyle,d=t.createRadialGradient(0,0,0,0,0,s*.2);d.addColorStop(0,"#FFD700"),d.addColorStop(1,"#FFA500"),t.fillStyle=d,t.beginPath(),t.arc(0,0,s*.2,0,Math.PI*2),t.fill(),t.fillStyle=r,t.restore()}function _(t,o,n,s){t.save(),t.translate(o,n),t.beginPath(),t.moveTo(0,0),t.lineTo(s,0),t.lineTo(0,s),t.closePath(),t.fill(),t.restore()}const Y=[{id:1,name:"Romantic Hearts",bgColor:"#1a1a2e",patternColor:"#ff6b9d",patternType:"heart",emoji:"üíñ",gradient:["#1a1a2e","#16213e"],description:"Dark romantic with pink hearts"},{id:2,name:"Starry Night",bgColor:"#0f172a",patternColor:"#fbbf24",patternType:"star",emoji:"‚≠ê",gradient:["#0f172a","#1e293b"],description:"Deep blue sky with golden stars"},{id:3,name:"Cherry Blossom",bgColor:"#fef3c7",patternColor:"#ec4899",patternType:"flower",emoji:"üå∏",gradient:["#fef3c7","#fde68a"],description:"Soft yellow with pink cherry blossoms"},{id:4,name:"Elegant Classic",bgColor:"#ffffff",patternColor:"#8b5cf6",patternType:"simple",emoji:"‚ú®",gradient:null,description:"Clean white with purple accents"},{id:5,name:"Sunset Dreams",bgColor:"#fef2f2",patternColor:"#f59e0b",patternType:"heart",emoji:"üåÖ",gradient:["#fef2f2","#fee2e2"],description:"Warm sunset with amber hearts"},{id:6,name:"Ocean Breeze",bgColor:"#e0f2fe",patternColor:"#06b6d4",patternType:"star",emoji:"üåä",gradient:["#e0f2fe","#bae6fd"],description:"Fresh ocean blue with cyan stars"},{id:7,name:"Lavender Fields",bgColor:"#faf5ff",patternColor:"#a855f7",patternType:"flower",emoji:"üíú",gradient:["#faf5ff","#f3e8ff"],description:"Lavender with purple flowers"},{id:8,name:"Golden Hour",bgColor:"#fff7ed",patternColor:"#ea580c",patternType:"star",emoji:"üåû",gradient:["#fff7ed","#ffedd5"],description:"Warm cream with orange stars"}];function ve(t,o=30){if(!t||t.length===0)return{width:800,height:600};let n=1/0,s=1/0,a=-1/0,r=-1/0;t.forEach(l=>{n=Math.min(n,l.x),s=Math.min(s,l.y),a=Math.max(a,l.x+l.w),r=Math.max(r,l.y+l.h)});const d=a-n+o*2,m=r-s+o*2;return{width:d,height:m,offsetX:n-o,offsetY:s-o}}async function Ne(t,o,n,s){const a=t.getContext("2d"),r=Y.find(u=>u.id===n)||Y[0],d=800,m=600,l=ye(o,d,m),i=[];for(let u=0;u<s.length&&u<l.length;u++)try{const j=await we(s[u]);i.push(j)}catch(j){console.error(`Error loading photo ${u}:`,j),i.push(null)}const x=be(l,i,d,m,o),{width:w,height:h,offsetX:y,offsetY:v}=ve(x);t.width=w,t.height=h;const g=x.map(u=>({...u,x:u.x-y,y:u.y-v}));if(r.gradient&&Array.isArray(r.gradient)){const u=a.createLinearGradient(0,0,w,h);u.addColorStop(0,r.gradient[0]),u.addColorStop(1,r.gradient[1]||r.gradient[0]),a.fillStyle=u}else a.fillStyle=r.bgColor;a.fillRect(0,0,w,h);for(let u=0;u<i.length&&u<g.length;u++){if(!i[u])continue;const j=i[u],{x:p,y:N,w:f,h:c}=g[u],k=8;a.fillStyle="#f5f5f5",W(a,p,N,f,c,k),a.fill(),a.save(),W(a,p,N,f,c,k),a.clip(),a.drawImage(j,p,N,f,c),a.restore(),a.save(),W(a,p,N,f,c,k),a.strokeStyle="rgba(255, 182, 193, 0.3)",a.lineWidth=2,a.stroke(),a.restore()}je(a,g,r)}function Ce(){var p,N;const t=D(),o=U(),n=((p=o.state)==null?void 0:p.photos)||[],s=((N=o.state)==null?void 0:N.photoCount)||n.length,[a,r]=b.useState(1),[d,m]=b.useState(null),[l,i]=b.useState(null),[x,w]=b.useState(!1),h=b.useRef(null),y=Y.map(f=>({id:f.id,name:f.name,emoji:f.emoji,description:`${f.patternType} pattern on ${f.bgColor==="#000000"?"black":f.bgColor==="#1E3A8A"?"blue":f.bgColor==="#FDF2F8"?"pink":"white"} background`})),v=[{id:1,name:"Cute Pink",emoji:"üíó",filter:"filter-pink",description:"Warm pink tones"},{id:2,name:"Sunset",emoji:"üåÖ",filter:"filter-sunset",description:"Golden hour vibes"},{id:3,name:"Vintage",emoji:"üì∑",filter:"filter-vintage",description:"Classic sepia"},{id:4,name:"Bright",emoji:"‚ú®",filter:"filter-bright",description:"Vibrant and clear"}];b.useEffect(()=>{n.length===0&&t("/")},[n,t]),b.useEffect(()=>{h.current&&n.length>0&&g()},[a,d,n]);const g=async()=>{if(!h.current||n.length===0)return;const f=h.current;f.width=800,f.height=600;try{if(await Ne(f,s,a,n),d){const c=v.find(k=>k.id===d);c&&pe(f,c.filter)}i(f.toDataURL("image/png"))}catch(c){console.error("Error generating preview:",c)}},u=async()=>{var c;if(!a){window.showToast&&window.showToast("Please select a template first!","warning",3e3);return}w(!0),window.showToast&&window.showToast("Generating your final photo...","info",2e3),l||(await g(),await new Promise(k=>setTimeout(k,500)));const f=((c=h.current)==null?void 0:c.toDataURL("image/png"))||l;setTimeout(()=>{window.showToast&&window.showToast("Photo generated successfully! üéâ","success",2e3),t("/result",{state:{photos:n,photoCount:s,templateId:a,filterId:d,finalImage:f||l}})},800)},j=()=>{t("/camera",{state:{photos:n}})};return e.jsxs("div",{className:"min-h-screen p-4",children:[e.jsx(L,{}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 animate-slide-in",children:[e.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white text-shadow-lg mb-4",children:"Customize Your Photos üé®"}),e.jsx("p",{className:"text-xl text-white/90 text-shadow mb-2",children:"Choose a decorative frame and filter to make your photos perfect"}),e.jsxs("p",{className:"text-lg text-white/80 text-shadow",children:["Layout: ",s===3?"Vertical (3 photos)":s===4?"Square (2√ó2)":"Rectangle (2√ó3)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs(S,{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-6 text-center",children:"Choose Decorative Frame üñºÔ∏è"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:y.map(f=>{const c=Y.find(k=>k.id===f.id);return e.jsxs("div",{onClick:()=>r(f.id),className:`p-4 rounded-2xl cursor-pointer transition-all duration-300 ${a===f.id?"scale-105 shadow-xl ring-4 ring-yellow-400":"hover:scale-102 hover:shadow-lg"}`,style:{background:c!=null&&c.gradient?`linear-gradient(135deg, ${c.gradient[0]}, ${c.gradient[1]})`:(c==null?void 0:c.bgColor)||"#ffffff",color:a===f.id?"#ffffff":"#333333"},children:[e.jsx("div",{className:"text-4xl mb-2 text-center",children:f.emoji}),e.jsx("p",{className:"text-base font-bold mb-1 text-center",children:f.name}),e.jsx("div",{className:"w-full h-16 rounded-lg mb-2 border-2",style:{borderColor:(c==null?void 0:c.patternColor)||"#000000",backgroundColor:(c==null?void 0:c.bgColor)||"#ffffff"},children:e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xl",children:f.emoji})}),e.jsx("p",{className:`text-xs text-center ${a===f.id?"text-white/90":"text-gray-600"}`,children:(c==null?void 0:c.description)||f.description})]},f.id)})})]}),e.jsxs(S,{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-6 text-center",children:"Choose Filter ‚ú®"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:v.map(f=>e.jsxs("div",{onClick:()=>m(f.id),className:`p-6 rounded-2xl cursor-pointer transition-all duration-300 ${d===f.id?"bg-gradient-to-r from-blue-400 to-cyan-500 text-white scale-105 shadow-xl ring-4 ring-yellow-400":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx("div",{className:"text-5xl mb-2",children:f.emoji}),e.jsx("p",{className:"text-lg font-bold mb-1",children:f.name}),e.jsx("p",{className:`text-sm ${d===f.id?"text-white/90":"text-gray-600"}`,children:f.description})]},f.id))})]})]}),e.jsxs(S,{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4 text-center",children:"Live Preview üëÄ"}),e.jsx("div",{className:"flex justify-center",children:l?e.jsx("img",{src:l,alt:"Preview",className:"max-w-full h-auto rounded-xl border-4 border-pink-300 shadow-2xl"}):e.jsxs("div",{className:"w-full h-96 bg-gray-200 rounded-xl flex items-center justify-center flex-col gap-4",children:[e.jsx(H,{size:"lg"}),e.jsx("div",{className:"text-gray-500 text-xl font-semibold",children:"Generating preview..."})]})}),e.jsx("canvas",{ref:h,className:"hidden"})]}),e.jsxs(S,{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:["Your Original Photos (",n.length,")"]}),e.jsx("div",{className:`grid gap-4 ${n.length===3?"grid-cols-3":n.length===4?"grid-cols-4":"grid-cols-6"}`,children:n.map((f,c)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f,alt:`Photo ${c+1}`,className:"w-full h-auto rounded-lg border-2 border-cute-pink shadow-lg"}),e.jsx("div",{className:"absolute top-1 left-1 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:c+1})]},c))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsx(T,{variant:"primary",size:"xl",onClick:u,disabled:!a||x,className:"min-w-[300px]",children:x?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(H,{size:"sm"}),"Generating Final Image..."]}):"üé® Generate Final Image"}),e.jsx(T,{variant:"ghost",size:"lg",onClick:j,disabled:x,children:"‚Üê Back to Camera"})]})]})]})}function ke(){const t=D(),o=U(),{photos:n,templateId:s,filterId:a,finalImage:r}=o.state||{},[d,m]=b.useState(!1),[l,i]=b.useState(null);b.useEffect(()=>{if(!n||n.length===0){t("/");return}m(!0)},[n,t]);const x=()=>{if(!r){window.showToast&&window.showToast("Image not ready yet","warning",2e3);return}const g=document.createElement("a");g.href=r,g.download=`cheese-and-click-${Date.now()}.png`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.showToast&&window.showToast("Photo downloaded successfully! üíæ","success",3e3)},w=async()=>{if(r)try{const u=await(await fetch(r)).blob(),j=new File([u],"photobooth.png",{type:"image/png"});navigator.share?await navigator.share({title:"My Photobooth Photo",text:"Check out my photobooth photo!",files:[j]}):(await navigator.clipboard.writeText(r),window.showToast&&window.showToast("Image URL copied to clipboard!","success",3e3))}catch(g){console.error("Error sharing:",g),x()}},h=()=>{if(!r)return;const g=window.open("","_blank");g.document.write(`
      <html>
        <head>
          <title>Print Photo</title>
          <style>
            body { margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
            img { max-width: 100%; height: auto; }
          </style>
        </head>
        <body>
          <img src="${r}" alt="Photobooth Photo" />
        </body>
      </html>
    `),g.document.close(),g.print()},y=()=>{t("/")},v=()=>{t("/select-frame")};return!n||n.length===0?null:e.jsxs("div",{className:"min-h-screen p-4",children:[e.jsx(L,{}),e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 animate-slide-in",children:[e.jsx("div",{className:"text-8xl mb-4 animate-bounce",children:"üéâ"}),e.jsx("h1",{className:"text-6xl md:text-7xl font-bold text-white text-shadow-lg mb-4",children:"All Done!"}),e.jsx("p",{className:"text-2xl text-white/90 text-shadow",children:"Your photobooth experience is complete"})]}),e.jsx(S,{className:"mb-8",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Your Final Photo ‚ú®"}),r?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:r,alt:"Final Photobooth Result",className:"max-w-full h-auto rounded-xl border-4 border-pink-300 shadow-2xl"}),d&&e.jsx("div",{className:"absolute top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-full text-sm font-bold animate-pulse",children:"Ready!"})]}):e.jsx("div",{className:"w-full h-96 bg-gray-200 rounded-xl flex items-center justify-center",children:e.jsx("div",{className:"text-gray-500 text-xl",children:"Processing final image..."})})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx(T,{variant:"primary",size:"lg",onClick:x,disabled:!d||!r,className:"w-full",children:"üíæ Download"}),e.jsx(T,{variant:"secondary",size:"lg",onClick:w,disabled:!d||!r,className:"w-full",children:"üì§ Share"}),e.jsx(T,{variant:"secondary",size:"lg",onClick:h,disabled:!d||!r,className:"w-full",children:"üñ®Ô∏è Print"}),e.jsx(T,{variant:"ghost",size:"lg",onClick:v,className:"w-full",children:"üì∏ New Session"})]}),e.jsxs(S,{className:"mb-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:["Original Photos (",n.length,")"]}),e.jsx("div",{className:`grid gap-3 ${n.length===3?"grid-cols-3":n.length===4?"grid-cols-4":"grid-cols-6"}`,children:n.map((g,u)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:g,alt:`Original ${u+1}`,className:"w-full h-auto rounded-lg border-2 border-gray-300"}),e.jsx("div",{className:"absolute top-1 left-1 bg-gray-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:u+1})]},u))})]}),e.jsx("div",{className:"text-center",children:e.jsx(T,{variant:"primary",size:"lg",onClick:y,children:"üè† Back to Home"})})]})]})}function Te(){return e.jsx(te,{basename:"/cheese-and-click/",children:e.jsxs(se,{children:[e.jsx($,{path:"/",element:e.jsx(me,{})}),e.jsx($,{path:"/select-frame",element:e.jsx(fe,{})}),e.jsx($,{path:"/camera",element:e.jsx(ge,{})}),e.jsx($,{path:"/template-filter",element:e.jsx(Ce,{})}),e.jsx($,{path:"/result",element:e.jsx(ke,{})})]})})}G.createRoot(document.getElementById("root")).render(e.jsx(ae.StrictMode,{children:e.jsx(Te,{})}));
